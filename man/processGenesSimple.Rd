% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculateTopLoadingGeneShifts.R
\name{processGenesSimple}
\alias{processGenesSimple}
\title{Process Genes for Statistical Analysis}
\usage{
processGenesSimple(
  top_genes,
  top_loadings,
  query_expr_matrix,
  ref_expr_matrix,
  cell_type
)
}
\arguments{
\item{top_genes}{Character vector of gene names to analyze.}

\item{top_loadings}{Numeric vector of PC loading values corresponding to the genes.}

\item{query_expr_matrix}{Numeric matrix of expression values for query data (genes × cells).}

\item{ref_expr_matrix}{Numeric matrix of expression values for reference data (genes × cells).}

\item{cell_type}{Character string specifying the cell type being analyzed.}
}
\value{
A list of data frames, where each data frame contains results for one gene with columns:
\itemize{
  \item gene: Gene symbol
  \item loading: PC loading value for the gene
  \item cell_type: Cell type analyzed
  \item p_value: Raw p-value from Wilcoxon rank-sum test
  \item mean_query: Mean expression in query data
  \item mean_reference: Mean expression in reference data
}
}
\description{
Internal helper function that performs statistical testing on top loading genes
to compare their expression distributions between query and reference datasets.
}
\details{
This function processes a set of top loading genes for a specific cell type by:
\itemize{
  \item Extracting expression values for each gene from query and reference matrices
  \item Removing NA values and checking for sufficient sample sizes
  \item Calculating mean expression values for both datasets
  \item Performing Wilcoxon rank-sum tests to assess distributional differences
  \item Returning results in a standardized data frame format
}
}
\author{
Anthony Christidis, \email{anthony-alexander_christidis@hms.harvard.edu}
}
\keyword{internal}
